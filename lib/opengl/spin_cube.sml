open GL;
open GLU;
open GLUT;

(* Draw a primitive *)
fun DrawPrim (_,[]) = glFlush ()
  | DrawPrim (obj,l) =
    let
	fun draw_vertices [] = ()
	  | draw_vertices ((x,y,z)::t) =
		    ((glVertex3d x y z); draw_vertices t)
	  
	fun draw_all [] = ()
	  | draw_all ((RGB(r,g,b), v)::t) =
	    ((glColor3d r g b) ; draw_vertices(v);
	     draw_all t)
    in
	(glBegin(obj);
	 draw_all l;
	 glEnd();
	 glFlush())
    end

(*Initialise(300,300);*)
  
fun loop () : unit = 
  (
   glClear(0);
   DrawPrim (GL_QUADS,
	     [
	      (RGB(0.9, 1.0, 0.0),
	       [(~1.0, 1.0, 1.0), (1.0,1.0,1.0)]),
	      (RGB(0.0,0.7,0.1),
	       [(1.0,~1.0,1.0),(~1.0,~1.0,1.0)]),
	      
	      (* (RGB(0.9,1.0,0.0),
	       [(~1.0,1.0,~1.0), (1.0,1.0,~1.0)]),
	       (RGB(0.2,0.2,1.0),
	       [(1.0,~1.0,~1.0), (~1.0,~1.0,~1.0)]), *)
	      
	      (RGB(0.2,0.2,1.0),
	       [(~1.0,1.0,~1.0), (1.0,1.0,~1.0)]),
	      (RGB(0.7,0.0,0.1),
	       [(1.0,~1.0,~1.0), (~1.0,~1.0,~1.0)]),
	      
	      (* (RGB(0.2,0.2,1.0),
	       [(~1.0,1.0,1.0), (1.0,1.0,1.0)]),
	       (RGB(0.7,0.0,0.1),
	       [(1.0,1.0,~1.0), (~1.0,1.0,~1.0)]), *)
	      
	      (RGB(0.9,1.0,0.0),
	       [(~1.0,1.0,1.0), (1.0,1.0,1.0)]),
	      (RGB(0.2,0.2,1.0),
	       [(1.0,1.0,~1.0), (~1.0,1.0,~1.0)]),
	      
	      (RGB(0.0,0.7,0.1),
	       [(~1.0,~1.0,1.0), (1.0,~1.0,1.0)]),
	      (RGB(0.7,0.0,0.1),
	       [(1.0,~1.0,~1.0), (~1.0,~1.0,~1.0)])
	      ]);
   
   glRotated 5.0 1.0 0.6 (~0.5);
   loop());
  
loop();
